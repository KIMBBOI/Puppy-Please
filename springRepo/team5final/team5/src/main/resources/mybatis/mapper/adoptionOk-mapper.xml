<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="AdoptionOkMapper">

    <!-- 입양 승인 리스트 조회 -->
    <select id="list" resultType="com.kh.app.adoptionOk.vo.AdoptionOkVo">
        SELECT *
    	FROM (
	        SELECT ROWNUM RNUM, T.*
	        FROM (
	        	SELECT
		        	A.ADOPTION_BOARD_NO
		        	, A.ADMIN_NO
		        	, A.ADOPTION_COMPLETE_YN
				    , A.DEL_YN
				    , RD.IMAGE_NO 
				    , RD.DOG_NAME
				    , RD.BREED
				    , RD.GENDER_MF
				    , RD.NEUTERING_OX
				    , RD.AGE
				    , RD.WEIGHT
				    , I.IMAGE_PATH
				FROM
				    ADOPTION_BOARD A
					JOIN RESCUE_DOG RD 
						ON A.RESCUE_DOG_NO = RD.RESCUE_DOG_NO
					JOIN IMAGE I
				  		ON I.IMAGE_NO = RD.IMAGE_NO
				WHERE
				    A.DEL_YN = 'N'
				AND
					A.ADOPTION_COMPLETE_YN = 'Y'
				ORDER BY
				    A.ENROLL_DATE DESC
	    	) T
		)
    </select>

    <!-- 입양 승인 상세 조회 -->
    <select id="detail" resultType="com.kh.app.adoptionOk.vo.AdoptionOkVo">
        SELECT ADOPTION_NO, IMAGE_NO, RESCUE_DOG_NO, ADMIN_NO, ENROLL_DATE, MODIFY_DATE, DEL_YN
        FROM ADOPTION_OK
        WHERE ADOPTION_NO = #{adoptionNo}
    </select>

    <!-- 입양 승인 등록 -->
    <insert id="insert" parameterType="com.kh.app.adoptionOk.vo.AdoptionOkVo">
        INSERT INTO ADOPTION_OK (ADOPTION_NO, IMAGE_NO, RESCUE_DOG_NO, ADMIN_NO, ENROLL_DATE, MODIFY_DATE, DEL_YN)
        VALUES (#{adoptionNo}, #{imageNo}, #{rescueDogNo}, #{adminNo}, #{enrollDate}, #{modifyDate}, #{delYn})
    </insert>

    <!-- 입양 승인 수정 -->
    <update id="edit" parameterType="com.kh.app.adoptionOk.vo.AdoptionOkVo">
        UPDATE ADOPTION_OK
        SET IMAGE_NO = #{imageNo},
            RESCUE_DOG_NO = #{rescueDogNo},
            ADMIN_NO = #{adminNo},
            ENROLL_DATE = #{enrollDate},
            MODIFY_DATE = #{modifyDate},
            DEL_YN = #{delYn}
        WHERE ADOPTION_NO = #{adoptionNo}
    </update>

    <!-- 입양 승인 삭제 -->
    <update id="delete">
        UPDATE ADOPTION_OK
        SET DEL_YN = 'Y'
        WHERE ADOPTION_NO = #{adoptionNo}
    </update>

</mapper>

  